- id: 28525
  solution:
    acts:
      - function: 'choose'
        args:
          - 'Purge or Mask'
          - 'What to do?'
          - 'purge'
          - 'mask'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'apt-get purge -y autofs'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'systemctl stop autofs'
              - function: 'execute'
                args:
                  - 'systemctl mask autofs'
- id: 28526
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y aide aide-common'
      - function: 'execute'
        args:
          - 'aideinit'
      - function: 'execute'
        args:
          - 'mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db'
- id: 28528
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /boot/grub/grub.cfg'
      - function: 'execute'
        args:
          - 'chmod u-wx,go-rwx /boot/grub/grub.cfg'
- id: 28530
  solution:
    acts:
      - function: 'execute'
        args:
          - 'prelink -ua'
      - function: 'execute'
        args:
          - 'apt-get purge -y prelink'
- id: 28531
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*enabled[[:space:]]*=.*'' /etc/default/apport && sed -i ''s/^[#[:space:]]*enabled[[:space:]]*=.*/enabled=0/'' /etc/default/apport || echo ''enabled=0'' >> /etc/default/apport'
      - function: 'choose'
        args:
          - 'Purge or Mask'
          - 'What to do?'
          - 'purge'
          - 'mask'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'apt-get purge -y apport'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'systemctl stop apport'
              - function: 'execute'
                args:
                  - 'systemctl --now disable apport'
- id: 28532
  solution:
    acts:
      - function: 'execute'
        args:
          - 'echo "* hard core 0" > /etc/security/limits.d/10-restrict-core-dump'
      - function: 'execute'
        args:
          - 'echo "fs.suid_dumpable = 0" > /etc/sysctl.d/10-restrict-core-dump'
      - function: 'execute'
        args:
          - 'sysctl -w fs.suid_dumpable=0'
      - function: 'execute'
        args:
          - 'if [ -f /etc/systemd/coredump.conf ]; then grep -qxE ''^[#[:space:]]*Storage[[:space:]]*=.*'' /etc/systemd/coredump.conf && sed -i ''s/^[#[:space:]]*Storage[[:space:]]*=.*/Storage=none/'' /etc/systemd/coredump.conf || echo "Storage=none" >> /etc/systemd/coredump.conf; fi'
      - function: 'execute'
        args:
          - 'if [ -f /etc/systemd/coredump.conf ]; then grep -qxE ''^[#[:space:]]*ProcessSizeMax[[:space:]]*=.*'' /etc/systemd/coredump.conf && sed -i ''s/^[#[:space:]]*ProcessSizeMax[[:space:]]*=.*/ProcessSizeMax=0/'' /etc/systemd/coredump.conf || echo "ProcessSizeMax=0" >> /etc/systemd/coredump.conf; fi'
      - function: 'execute'
        args:
          - '[ -f /etc/systemd/coredump.conf ] && systemctl daemon-reload'
- id: 28533
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y apparmor'
- id: 28534
  solution:
    acts:
      - function: 'nano'
        args:
          - '/etc/default/grub'
          - 'add the apparmor=1 and security=apparmor parameters to the GRUB_CMDLINE_LINUX= line GRUB_CMDLINE_LINUX="apparmor=1 security=apparmor"'
      - function: 'execute'
        args:
          - 'update-grub'

- id: 28535
  solution:
    acts:
      - function: 'choose'
        args:
          - 'Enforce or Complain'
          - 'What to do?'
          - 'enforce'
          - 'complain'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'aa-enforce /etc/apparmor.d/*'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'aa-complain /etc/apparmor.d/*'
- id: 28536
  solution:
    acts:
      - function: 'execute'
        args:
          - 'aa-enforce /etc/apparmor.d/*'
- id: 28537
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/motd'
      - function: 'execute'
        args:
          - 'echo " " > /etc/motd'
- id: 28538
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/issue'
      - function: 'execute'
        args:
          - 'echo "Authorized uses only. All activity may be monitored and reported." > /etc/issue'
- id: 28539
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/issue.net'
      - function: 'execute'
        args:
          - 'echo "Authorized uses only. All activity may be monitored and reported." > /etc/issue.net'
- id: 28540
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/motd'
      - function: 'execute'
        args:
          - 'chmod u-x,go-wx /etc/motd'
- id: 28541
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/issue'
      - function: 'execute'
        args:
          - 'chmod u-x,go-wx /etc/issue'
- id: 28542
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/issue.net'
      - function: 'execute'
        args:
          - 'chmod u-x,go-wx /etc/issue.net'
- id: 28543
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y gdm3'
- id: 28544
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/gdm3/custom.conf'
      - function: 'execute'
        args:
          - 'sed -i ''s/^[[:space:]]*Enabled[[:space:]]*=[[:space:]]*true/#Enabled=true/'' /etc/gdm3/custom.conf'
- id: 28545
  solution:
    acts:
      - function: 'execute'
        args:
          - 'echo "user _chrony" >> /etc/chrony/chrony.conf'
- id: 28546
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl unmask chrony.service'
      - function: 'execute'
        args:
          - 'systemctl --now enable chrony.service'
- id: 28547
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl unmask systemd-timesyncd.service'
      - function: 'execute'
        args:
          - 'systemctl --now enable systemd-timesyncd.service'
- id: 28548
  solution:
    acts:
      - function: 'nano'
        args:
          - '/etc/ntp.conf'
          - "Add or edit restrict lines in /etc/ntp.conf to match the following\n\nrestrict -4 default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery"
- id: 28549
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*RUNASUSER[[:space:]]*=.*'' /etc/init.d/ntp && sed -i ''s/^[#[:space:]]*RUNASUSER[[:space:]]*=.*/RUNASUSER=ntp/'' /etc/init.d/ntp || echo "RUNASUSER=ntp" >> /etc/init.d/ntp'
      - function: 'execute'
        args:
          - 'systemctl restart ntp.service'
- id: 28550
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl unmask ntp.service'
      - function: 'execute'
        args:
          - 'systemctl --now enable ntp.service'
- id: 28551
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y xserver-xorg*'
- id: 28552
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl stop avahi-daaemon.service'
      - function: 'execute'
        args:
          - 'systemctl stop avahi-daemon.socket'
      - function: 'execute'
        args:
          - 'apt-get purge -y avahi-daemon'
- id: 28553
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y cups'
- id: 28554
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y isc-dhcp-server'
- id: 28555
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y slapd'
- id: 28556
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y nfs-kernel-server'
- id: 28557
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y bind9'
- id: 28558
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y vsftpd'
- id: 28559
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y apache2'
- id: 28560
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y dovecot-imapd dovecot-pop3d'
- id: 28561
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y samba'
- id: 28562
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y squid'
- id: 28563
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y snmp'
- id: 28564
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y nis'
- id: 28565
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*inet_interfaces[[:space:]]*=.*'' /etc/postfix/main.cf && sed -i ''s/^[#[:space:]]*inet_interfaces[[:space:]]*=.*/inet_interfaces = loopback-only/'' /etc/postfix/main.cf || echo "inet_interfaces = loopback-only" >> /etc/postfix/main.cf'
      - function: 'execute'
        args:
          - 'systemctl restart postfix'
- id: 28566
  solution:
    acts:
      - function: 'choose'
        args:
          - 'Purge or Mask'
          - 'What to do?'
          - 'purge'
          - 'mask'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'apt-get purge -y rsync'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'systemctl stop rsync'
              - function: 'execute'
                args:
                  - 'systemctl mask rsync'
- id: 28567
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y nis'
- id: 28568
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y rsh-client'
- id: 28569
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y talk'
- id: 28570
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y telnet'
- id: 28571
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y ldap-utils'
- id: 28572
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y rpcbind'
- id: 28573
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y ufw'
- id: 28574
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y iptables-persistent'
- id: 28575
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl unmask ufw.service'
      - function: 'execute'
        args:
          - 'systemctl --now enable ufw.service'
      - function: 'execute'
        args:
          - 'ufw --force enable'
- id: 28576
  solution:
    acts:
      - function: 'execute'
        args:
          - 'ufw allow in on lo'
      - function: 'execute'
        args:
          - 'ufw allow out on lo'
      - function: 'execute'
        args:
          - 'ufw deny in from 127.0.0.0/8'
      - function: 'execute'
        args:
          - 'ufw deny in from ::1'
- id: 28577
  solution:
    acts:
      - function: 'execute'
        args:
          - 'ufw default deny incoming'
      - function: 'execute'
        args:
          - 'ufw default deny outgoing'
      - function: 'execute'
        args:
          - 'ufw default deny routed'
- id: 28578
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y nftables'
- id: 28579
  solution:
    acts:
      - function: 'execute'
        args:
          - 'nft create table inet filter'
- id: 28580
  solution:
    acts:
      - function: 'execute'
        args:
          - 'nft create chain inet filter input { type filter hook input priority 0 \; }'
      - function: 'execute'
        args:
          - 'nft create chain inet filter forward { type filter hook forward priority 0 \\; }'
      - function: 'execute'
        args:
          - 'nft create chain inet filter output { type filter hook output priority 0 \\; }'
- id: 28581
  solution:
    acts:
      - function: 'execute'
        args:
          - 'nft chain inet filter input { policy drop \; }'
      - function: 'execute'
        args:
          - 'nft chain inet filter forward { policy drop \; }'
      - function: 'execute'
        args:
          - 'nft chain inet filter output { policy drop \; }'
- id: 28582
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl enable nftables'
- id: 28583
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y iptables iptables-persistent'
- id: 28584
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get purge -y nftables'
- id: 28585
  solution:
    acts:
      - function: 'choose'
        args:
          - 'Purge or Mask'
          - 'What to do?'
          - 'purge'
          - 'mask'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'apt-get purge -y ufw'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'ufw disable'
              - function: 'execute'
                args:
                  - 'systemctl stop ufw'
              - function: 'execute'
                args:
                  - 'systemctl mask ufw'
- id: 28586
  solution:
    acts:
      - function: 'execute'
        args:
          - 'iptables -P INPUT DROP'
      - function: 'execute'
        args:
          - 'iptables -P OUTPUT DROP'
      - function: 'execute'
        args:
          - 'iptables -P FORWARD DROP'
- id: 28587
  solution:
    acts:
      - function: 'execute'
        args:
          - 'iptables -A INPUT -i lo -j ACCEPT'
      - function: 'execute'
        args:
          - 'iptables -A OUTPUT -o lo -j ACCEPT'
      - function: 'execute'
        args:
          - 'iptables -A INPUT -s 127.0.0.0/8 -j DROP'
- id: 28588
  solution:
    acts:
      - function: 'execute'
        args:
          - 'ip6tables -P INPUT DROP'
      - function: 'execute'
        args:
          - 'ip6tables -P OUTPUT DROP'
      - function: 'execute'
        args:
          - 'ip6tables -P FORWARD DROP'
- id: 28589
  solution:
    acts:
      - function: 'execute'
        args:
          - 'ip6tables -A INPUT -i lo -j ACCEPT'
      - function: 'execute'
        args:
          - 'ip6tables -A OUTPUT -o lo -j ACCEPT'
      - function: 'execute'
        args:
          - 'ip6tables -A INPUT -s ::1 -j DROP'
- id: 28590
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y auditd audispd-plugins'
- id: 28591
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl --now enable auditd'
- id: 28592
  solution:
    acts:
      - function: 'nano'
        args:
          - '/etc/default/grub'
          - 'add audit=1 to GRUB_CMDLINE_LINUX: Example: GRUB_CMDLINE_LINUX="audit=1"'
      - function: 'execute'
        args:
          - 'update-grub'
- id: 28593
  solution:
    acts:
      - function: 'nano'
        args:
          - '/etc/default/grub'
          - 'add audit_backlog_limit=N to GRUB_CMDLINE_LINUX. The recommended size for N is 8192 or larger. Example: GRUB_CMDLINE_LINUX="audit_backlog_limit=8192"'
      - function: 'execute'
        args:
          - 'update-grub'
- id: 28594
  solution:
    acts:
      - function: 'nano'
        args:
          - '/etc/audit/auditd.conf'
          - 'Set the following parameter in accordance with site policy: max_log_file = <MB>'
- id: 28595
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*max_log_file_action[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*max_log_file_action[[:space:]]*=.*/max_log_file_action=keep_logs/'' /etc/audit/auditd.conf || echo "max_log_file_action=keep_logs" >> /etc/audit/auditd.conf'
- id: 28596
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*action_mail_acct[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*action_mail_acct[[:space:]]*=.*/action_mail_acct=root/'' /etc/audit/auditd.conf || echo "action_mail_acct=root" >> /etc/audit/auditd.conf'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*space_left_action[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*space_left_action[[:space:]]*=.*/space_left_action=email/'' /etc/audit/auditd.conf || echo "space_left_action=email" >> /etc/audit/auditd.conf'
      - function: 'choose'
        args:
          - 'Halt or SingleUser'
          - 'What to do?'
          - 'halt'
          - 'single'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'grep -qxE ''^[#[:space:]]*admin_space_left_action[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*admin_space_left_action[[:space:]]*=.*/admin_space_left_action=halt/'' /etc/audit/auditd.conf || echo "admin_space_left_action=halt" >> /etc/audit/auditd.conf'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'grep -qxE ''^[#[:space:]]*admin_space_left_action[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*admin_space_left_action[[:space:]]*=.*/admin_space_left_action=single/'' /etc/audit/auditd.conf || echo "admin_space_left_action=single" >> /etc/audit/auditd.conf'
- id: 28597
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-scope.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure changes to system administration scope (sudoers) is collected\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d -p wa -k scope\" > /etc/audit/rules.d/50-scope.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28598
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-user_emulation.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure actions as another user are always logged\n-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k user_emulation\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k user_emulation\" > /etc/audit/rules.d/50-user_emulation.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28599
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-time-change.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure events that modify date and time information are collected\n-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time-change\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change\" > /etc/audit/rules.d/50-time-change.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28600
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-system_local.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure events that modify the system's network environment are collected\n-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/networks -p wa -k system-locale\n-w /etc/network/ -p wa -k system-locale\" > /etc/audit/rules.d/50-system_local.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28601
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-identity.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure events that modify user/group information are collected\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\" > /etc/audit/rules.d/50-identity.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28602
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-session.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure session initiation information is collected\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\" > /etc/audit/rules.d/50-session.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28603
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-login.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure login and logout events are collected\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock -p wa -k logins\" > /etc/audit/rules.d/50-login.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28604
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/50-MAC-policy.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure events that modify the system's Mandatory Access Controls are collected\n-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\" > /etc/audit/rules.d/50-MAC-policy.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28605
  solution:
    recheck: false
    acts:
      - function: 'backup'
        args:
          - '/etc/audit/rules.d/99-finalize.rules'
      - function: 'execute'
        args:
          - "echo \"# Ensure the audit configuration is immutable.\n-e 2\" > /etc/audit/rules.d/99-finalize.rules"
      - function: 'execute'
        args:
          - 'augenrules --load'
      - function: 'set_reboot_required'
- id: 28606
  solution:
    acts:
      - function: 'execute'
        args:
          - 'find $(dirname $(awk -F"=" ''/^[[:space:]]*log_file[[:space:]]*=[[:space:]]*/ {print $2}'' /etc/audit/auditd.conf | xargs)) -type f \( ! -group adm -a ! -group root \) -exec chgrp adm {} +'
      - function: 'execute'
        args:
          - 'chgrp adm /var/log/audit/'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*log_group[[:space:]]*=.*'' /etc/audit/auditd.conf && sed -i ''s/^[#[:space:]]*log_group[[:space:]]*=.*/log_group=adm/'' /etc/audit/auditd.conf || echo "log_group=adm" >> /etc/audit/auditd.conf'
      - function: 'execute'
        args:
          - 'systemctl restart auditd'
- id: 28607
  solution:
    acts:
      - function: 'execute'
        args:
          - 'find /etc/audit/ -type f \( -name ''*.conf'' -o -name ''*.rules'' \) -exec chmod u-x,g-wx,o-rwx {} +'
- id: 28608
  solution:
    acts:
      - function: 'execute'
        args:
          - 'find /etc/audit/ -type f \( -name ''*.conf'' -o -name ''*.rules'' \) ! -user root -exec chown root {} +'
- id: 28609
  solution:
    acts:
      - function: 'execute'
        args:
          - 'find /etc/audit/ -type f \( -name ''*.conf'' -o -name ''*.rules'' \) ! -group root -exec chgrp root {} +'
- id: 28610
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules'
- id: 28611
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules'
- id: 28612
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules'
      - function: 'execute'
        args:
          - 'chown root:root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules'
- id: 28613
  solution:
    acts:
      - function: 'execute'
        args:
          - 'echo "\n# Audit Tools\n/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512" >> /etc/aide/aide.conf'
- id: 28614
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y systemd-journal-remote'
- id: 28615
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl --now disable systemd-journal-remote.socket'
- id: 28617
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*Compress[[:space:]]*=.*'' /etc/systemd/journald.conf && sed -i ''s/^[#[:space:]]*Compress[[:space:]]*=.*/Compress=yes/'' /etc/systemd/journald.conf || echo "Compress=yes" >> /etc/systemd/journald.conf'
      - function: 'execute'
        args:
          - 'systemctl restart systemd-journald'
- id: 28618
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*Storage[[:space:]]*=.*'' /etc/systemd/journald.conf && sed -i ''s/^[#[:space:]]*Storage[[:space:]]*=.*/Storage=persistent/'' /etc/systemd/journald.conf || echo "Storage=persistent" >> /etc/systemd/journald.conf'
      - function: 'execute'
        args:
          - 'systemctl restart systemd-journald'
- id: 28619
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*ForwardToSyslog[[:space:]]*=.*'' /etc/systemd/journald.conf && sed -i ''s/^[#[:space:]]*ForwardToSyslog[[:space:]]*=.*/ForwardToSyslog=no/'' /etc/systemd/journald.conf || echo "ForwardToSyslog=no" >> /etc/systemd/journald.conf'
      - function: 'execute'
        args:
          - 'systemctl restart systemd-journald'
- id: 28620
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y rsyslog'
- id: 28621
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl --now enable rsyslog'
- id: 28622
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*ForwardToSyslog[[:space:]]*=.*'' /etc/systemd/journald.conf && sed -i ''s/^[#[:space:]]*ForwardToSyslog[[:space:]]*=.*/ForwardToSyslog=yes/'' /etc/systemd/journald.conf || echo "ForwardToSyslog=yes" >> /etc/systemd/journald.conf'
- id: 28623
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/rsyslog.d/set-file-create-mode.conf'
      - function: 'execute'
        args:
          - 'echo "\$FileCreateMode 0640" > /etc/rsyslog.d/set-file-create-mode.conf'
      - function: 'execute'
        args:
          - 'systemctl restart rsyslog'
- id: 28624
  solution:
    acts:
      - function: 'execute'
        args:
          - 'sed -i ''s/^[[:space:]]*module(load="imtcp")/#module(load="imtcp")/'' /etc/rsyslog.conf'
      - function: 'execute'
        args:
          - 'find /etc/rsyslog.d/ -name "*.conf" -exec sed -i ''s/^[[:space:]]*module(load="imtcp")/#module(load="imtcp")/'' {} \;'
      - function: 'execute'
        args:
          - 'sed -i ''s/^[[:space:]]*input(type="imtcp" /#input(type="imtcp" /'' /etc/rsyslog.conf'
      - function: 'execute'
        args:
          - 'find /etc/rsyslog.d/ -name "*.conf" -exec sed -i ''s/^[[:space:]]*input(type="imtcp" /#input(type="imtcp" /'' {} \;'
      - function: 'execute'
        args:
          - 'systemctl restart rsyslog'
- id: 28625
  solution:
    acts:
      - function: 'execute'
        args:
          - 'systemctl --now enable cron'
- id: 28626
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/crontab'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/crontab'
- id: 28627
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.hourly'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/cron.hourly'
- id: 28628
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.daily'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/cron.daily'
- id: 28629
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.weekly'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/cron.weekly'
- id: 28630
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.monthly'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/cron.monthly'
- id: 28631
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.d'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/cron.d'
- id: 28632
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/cron.deny'
      - function: 'execute'
        args:
          - 'rm -rf /etc/cron.deny'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[[:space:]]*root[[:space:]]*'' /etc/cron.allow && sed -i ''s/^[[:space:]]*root[[:space:]]*/root/'' /etc/cron.allow || echo ''root'' >> /etc/cron.allow'
      - function: 'execute'
        args:
          - 'chown root:root /etc/cron.allow'
      - function: 'execute'
        args:
          - 'chmod u-x,go-rwx /etc/cron.allow'
      - function: 'nano'
        args:
          - '/etc/cron.allow'
          - 'add additional administrator (if needed) users to /etc/cron.allow'
- id: 28633
  solution:
    acts:
      - function: 'backup'
        args:
          - '/etc/at.deny'
      - function: 'execute'
        args:
          - 'rm -rf /etc/at.deny'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[[:space:]]*root[[:space:]]*'' /etc/at.allow && sed -i ''s/^[[:space:]]*root[[:space:]]*/root/'' /etc/at.allow || echo ''root'' >> /etc/at.allow'
      - function: 'execute'
        args:
          - 'chown root:root /etc/at.allow'
      - function: 'execute'
        args:
          - 'chmod u-x,go-rwx /etc/at.allow'
      - function: 'nano'
        args:
          - '/etc/at.allow'
          - 'add additional administrator (if needed) users to /etc/at.allow'
- id: 28634
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'chmod og-rwx /etc/ssh/sshd_config'
- id: 28635
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*AllowUsers.*'' /etc/ssh/sshd_config || echo "#AllowUsers " >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*AllowGroups.*'' /etc/ssh/sshd_config || echo "#AllowGroups " >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*DenyUsers.*'' /etc/ssh/sshd_config || echo "#DenyUsers " >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*DenyGroups.*'' /etc/ssh/sshd_config || echo "#DenyGroups " >> /etc/ssh/sshd_config'
      - function: 'nano'
        args:
          - '/etc/ssh/sshd_config'
          - 'edit set one or more of the parameter as follows: AllowUsers <userlist> OR AllowGroups <grouplist> OR DenyUsers <userlist> OR DenyGroups <grouplist>'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28636
  solution:
    acts:
      - function: 'choose'
        args:
          - 'Ensure SSH LogLevel is appropriate'
          - 'What to set?'
          - 'INFO'
          - 'VERBOSE'
        on_response:
          - value: 0
            acts:
              - function: 'execute'
                args:
                  - 'grep -qxE ''^[#[:space:]]*LogLevel.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*LogLevel.*/LogLevel INFO/'' /etc/ssh/sshd_config || echo "LogLevel INFO" >> /etc/ssh/sshd_config'
          - value: 1
            acts:
              - function: 'execute'
                args:
                  - 'grep -qxE ''^[#[:space:]]*LogLevel.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*LogLevel.*/LogLevel VERBOSE/'' /etc/ssh/sshd_config || echo "LogLevel VERBOSE" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28637
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*UsePAM.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*UsePAM.*/UsePAM yes/'' /etc/ssh/sshd_config || echo "UsePAM yes" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28638
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*PermitRootLogin.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*PermitRootLogin.*/PermitRootLogin no/'' /etc/ssh/sshd_config || echo "PermitRootLogin no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28639
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*HostbasedAuthentication.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*HostbasedAuthentication.*/HostbasedAuthentication no/'' /etc/ssh/sshd_config || echo "HostbasedAuthentication no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28640
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*PermitEmptyPasswords.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*PermitEmptyPasswords.*/PermitEmptyPasswords no/'' /etc/ssh/sshd_config || echo "PermitEmptyPasswords no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28641
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*PermitUserEnvironment.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*PermitUserEnvironment.*/PermitUserEnvironment no/'' /etc/ssh/sshd_config || echo "PermitUserEnvironment no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28642
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*IgnoreRhosts.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*IgnoreRhosts.*/IgnoreRhosts yes/'' /etc/ssh/sshd_config || echo "IgnoreRhosts yes" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28643
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*X11Forwarding.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*X11Forwarding.*/X11Forwarding no/'' /etc/ssh/sshd_config || echo "X11Forwarding no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28644
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*Ciphers.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*Ciphers.*/Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128- gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr/'' /etc/ssh/sshd_config || echo "Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128- gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr" >> /etc/ssh/sshd_config'
- id: 28645
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*MACs.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*MACs.*/MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256/'' /etc/ssh/sshd_config || echo "MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256" >> /etc/ssh/sshd_config'
- id: 28646
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*KexAlgorithms.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*KexAlgorithms.*/KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256/'' /etc/ssh/sshd_config || echo "KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256" >> /etc/ssh/sshd_config'
- id: 28647
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*AllowTcpForwarding.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*AllowTcpForwarding.*/AllowTcpForwarding no/'' /etc/ssh/sshd_config || echo "AllowTcpForwarding no" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28648
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*Banner.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*Banner.*/Banner \/etc\/issue.net/'' /etc/ssh/sshd_config || echo "Banner \/etc\/issue.net" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28649
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*MaxAuthTries.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*MaxAuthTries.*/MaxAuthTries 4'' /etc/ssh/sshd_config || echo "MaxAuthTries 4" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28650
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*MaxStartups.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*MaxStartups.*/MaxStartups 10:30:60'' /etc/ssh/sshd_config || echo "MaxStartups 10:30:60" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28651
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*MaxSessions.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*MaxSessions.*/MaxSessions 10'' /etc/ssh/sshd_config || echo "MaxSessions 10" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28652
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*LoginGraceTime.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*LoginGraceTime.*/LoginGraceTime 60'' /etc/ssh/sshd_config || echo "LoginGraceTime 60" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28653
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*ClientAliveInterval.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*ClientAliveInterval.*/ClientAliveInterval 100'' /etc/ssh/sshd_config || echo "ClientAliveInterval 100" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*ClientAliveCountMax.*'' /etc/ssh/sshd_config && sed -i ''s/^[#[:space:]]*ClientAliveCountMax.*/ClientAliveCountMax 3'' /etc/ssh/sshd_config || echo "ClientAliveCountMax 3" >> /etc/ssh/sshd_config'
      - function: 'execute'
        args:
          - 'systemctl restart sshd'
- id: 28654
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y sudo'
- id: 28655
  solution:
    acts:
      - function: 'execute'
        args:
          - 'echo "Defaults use_pty" > /etc/sudoers.d/default-use-pty'
- id: 28656
  solution:
    acts:
      - function: 'execute'
        args:
          - 'echo "Defaults logfile=\"/var/log/sudo.log\" " > /etc/sudoers.d/default-sudo-logfile'
- id: 28657
  solution:
    acts:
      - function: 'execute'
        args:
          - 'sed -ri ''s/^[^#](.*NOPASSWD.*)/#\1/'' /etc/sudoers'
      - function: 'execute'
        args:
          - 'find /etc/sudoers.d/ -type f -name "*" -exec sed -ri ''s/^[^#](.*NOPASSWD.*)/#\1/'' {} \;'
- id: 28659
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[#[:space:]]*Defaults[[:space:]]+timestamp_timeout[[:space:]]*=.*'' /etc/sudoers && sed -i ''s/^[#[:space:]]*Defaults[[:space:]]*timestamp_timeout[[:space:]]*=.*/Defaults timestamp_timeout=5/'' /etc/sudoers || echo "Defaults timestamp_timeout=5" >> /etc/sudoers'
- id: 28661
  solution:
    acts:
      - function: 'execute'
        args:
          - 'apt-get install -y libpam-pwquality'
      - function: 'execute'
        args:
          - 'sed -i ''s/^[#[:space:]]*minlen[[:space:]]*=.*/minlen = 14/'' /etc/security/pwquality.conf '
      - function: 'execute'
        args:
          - 'sed -i ''s/^[#[:space:]]*minclass[[:space:]]*=.*/minclass = 4/'' /etc/security/pwquality.conf '
- id: 28665
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[[:space:]]*PASS_MIN_DAYS.*'' /etc/login.defs && sed -i ''s/^[[:space:]]*PASS_MIN_DAYS.*/PASS_MIN_DAYS 7/'' /etc/login.defs || echo "PASS_MIN_DAYS 7" >> /etc/login.defs'
      - function: 'execute'
        args:
          - 'sed -ri ''s/^(\w+:\$[^:]+:[^:]*:)[^:]*(.*)/\17\2/'' /etc/shadow'
- id: 28666
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[[:space:]]*PASS_MAX_DAYS.*'' /etc/login.defs && sed -i ''s/^[[:space:]]*PASS_MAX_DAYS.*/PASS_MAX_DAYS 365/'' /etc/login.defs || echo "PASS_MAX_DAYS 365" >> /etc/login.defs'
      - function: 'execute'
        args:
          - 'sed -ri ''s/^(\w+:\$[^:]+:[^:]*:[^:]*:)[^:]*(.*)/\1365\2/'' /etc/shadow'
- id: 28667
  solution:
    acts:
      - function: 'execute'
        args:
          - 'grep -qxE ''^[[:space:]]*PASS_WARN_AGE.*'' /etc/login.defs && sed -i ''s/^[[:space:]]*PASS_WARN_AGE.*/PASS_WARN_AGE 30/'' /etc/login.defs || echo "PASS_WARN_AGE 30" >> /etc/login.defs'
      - function: 'execute'
        args:
          - 'sed -ri ''s/^(\w+:\$[^:]+:[^:]*:[^:]*:[^:]*:)[^:]*(.*)/\17\2/'' /etc/shadow'
- id: 28668
  solution:
    acts:
      - function: 'execute'
        args:
          - 'useradd -D -f 30'
      - function: 'execute'
        args:
          - 'sed -ri ''/^root:/!s/^(\w+:\$[^:]+:[^:]*:[^:]*:[^:]*:[^:]*:)[^:]*(.*)/\130\2/'' /etc/shadow'
- id: 28669
  solution:
    acts:
      - function: 'execute'
        args:
          - 'usermod -g 0 root'
- id: 28670
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/passwd'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/passwd'
- id: 28671
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/passwd-'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/passwd-'
- id: 28672
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/group'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/group'
- id: 28673
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/group-'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/group-'
- id: 28674
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/shadow'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/shadow'
- id: 28675
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/shadow-'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/shadow-'
- id: 28676
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/gshadow'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/gshadow'
- id: 28677
  solution:
    acts:
      - function: 'execute'
        args:
          - 'chown root:root /etc/gshadow-'
      - function: 'execute'
        args:
          - 'chmod 644 /etc/gshadow-'
- id: 28678
  solution:
    acts:
      - function: 'execute'
        args:
          - 'sed -e ''s/^([a-zA-Z0-9_]*):[^:]*:/1:x:/'' -i /etc/passwd'
- id: 28679
  solution:
    acts:
      - function: 'execute'
        args:
          - 'sed -rn "s/^(\w+)::.*/\1/p" /test | while read user; do passwd -l $user; done'